// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int      @id @default(autoincrement())
  
  // 필수 필드
  email         String   @unique @db.VarChar(255)
  // ⭐ 추가: 비밀번호 해싱 미션을 반영
  password      String   @db.VarChar(255) 

  name          String   @db.VarChar(100)
  gender        String   @db.VarChar(15)
  birth         DateTime @db.Date
  
  // NULL 허용 필드 (스크린샷에서 NULL 값이 관찰됨)
  address       String?  @db.VarChar(255) // ⭐ String 뒤에 ? 추가 (NULL 허용)
  
  // detail_address는 DB에 NULL이 있으므로 Optional(?)로 정의
  detailAddress String?  @map("detail_address") @db.VarChar(255) 
  
  // phone_number도 DB에 NULL이 있으므로 Optional(?)로 정의
  phoneNumber   String?  @map("phone_number") @db.VarChar(15) 

  userFavorCategories UserFavorCategory[]

  // (관계 필드: UserFavorCategory, Review, Mission 등은 필요시 여기에 추가되어야 합니다.)

  @@map("user") // 실제 DB 테이블 이름
}

model FoodCategory {
  id   Int    @id @default(autoincrement())
  name String @db.VarChar(100)

  userFavorCategories UserFavorCategory[]

  @@map("food_category")
}

// ⭐ [추가] N:M 관계를 위한 중간 테이블 모델
model UserFavorCategory {
  id             Int          @id @default(autoincrement())
  
  // User 관계 설정
  user           User         @relation(fields: [userId], references: [id])
  userId         Int          @map("user_id") // DB 컬럼: user_id
  
  // FoodCategory 관계 설정
  category       FoodCategory @relation(fields: [categoryId], references: [id])
  categoryId     Int          @map("food_category_id") // DB 컬럼: food_category_id

  @@index([categoryId], map: "f_category_id")
  @@index([userId], map: "user_id")
  @@map("user_favor_category") // 실제 DB 테이블 이름
}